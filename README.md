# Hearts AI Project

A comprehensive Hearts card game implementation with automated AI training using Reinforcement Learning (RL) concepts and a pygame-based graphical interface.

## Overview

This project implements the card game **Hearts** for 3 and 4 players. It includes a rule-based AI whose performance is optimized through a training script that adjusts heuristic weights.

## Installation

1. Ensure you have Python 3.10+ installed.
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
   *(Note: The project uses `pygame-ce`, `torch`, and `numpy`.)*

## CLI Scripts Usage

### 1. Graphical User Interface (`hearts_gui.py`)
Launch the main game window to play against AI or watch AI play against itself.

```bash
python hearts_gui.py [options]
```

**Options:**
- `--players, -p {3,4}`: Set the number of players (default: 4).
- `--kitty`: Enable "Kitty" mode for 3-player games.
- `--auto`: Run in "Watch Mode" where all players are AI.
- `--delay DELAY`: Seconds to wait between AI moves in auto mode (default: 1.0).

### 2. AI Training (`hearts_learn.py`)
Train the AI heuristic weights using a simulated environment and reinforcement learning.

```bash
python hearts_learn.py [options]
```

**Options:**
- `--epochs, -e EPOCHS`: Maximum training epochs (default: 100).
- `--games, -g GAMES`: Number of games to simulate per epoch (default: 20).
- `--lr LR`: Learning rate for weight updates (default: 0.01).
- `--threshold, -t THRESHOLD`: Convergence threshold (default: 0.1).
- `--players, -p {3,4}`: Number of players to train for.
- `--kitty`: Use kitty mode for 3-player training.
- `--all-modes`: sequentially train for all supported game modes (4p, 3p-remove, 3p-kitty).
- `--save, -s SAVE`: Path to save the optimized weights (e.g., `learned_weights.py`).

### 3. Verification Script (`verify_heuristics.py`)
Evaluate the performance of the current AI weights (learned vs. default) over many simulations.

```bash
python verify_heuristics.py [options]
```

**Options:**
- `--players, -p {3,4}`: Number of players to test (runs all modes if omitted).
- `--kitty`: Use kitty mode for 3-player verification.
- `--games, -g GAMES`: Number of games to simulate for verification (default: 50).

## Project Structure

- `hearts_game.py`: Core game logic, rules, and state management.
- `hearts_ai.py`: AI implementation with heuristic-based decision making.
- `hearts_learn.py`: Training infrastructure using PyTorch.
- `hearts_gui.py`: Pygame-based GUI.
- `learned_weights.py`: Optimized weights generated by the training script.
- `tests/`: Comprehensive test suite for game mechanics and AI.

## Testing and Coverage

Run the test suite with coverage reporting:
```bash
pytest --cov
```
The project maintains high coverage standards (>95% for core modules).
